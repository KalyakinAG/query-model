# Объектная модель работы со схемой запроса

Объектная модель построена на использовании внешнего интерфейса библиотеки ["Работа со схемой запроса"](https://infostart.ru/1c/articles/811832/). Модель позволяет скрыть переменные контекста работы с библиотекой и использовать вызов методов в стиле текучего интерфейса.

## Конструктор модели запроса

    МодельЗапроса = Общий.МодельЗапроса();
    МодельЗапроса = Общий.МодельЗапроса(ТекстЗапроса);
    МодельЗапроса = Общий.МодельЗапроса(СхемаКомпоновкиДанных, НастройкиКомпоновкиДанных);
    МодельЗапроса = Общий.МодельЗапроса(ДинамическийСписок);

## Обработка "Конструктор модели запроса"

Интерактивная обработка позволяет генерировать код модели на основе текста запроса. Описание работы аналогично с ['Обработка "Конструктор схемы запроса"'](https://infostart.ru/1c/articles/811832/#_Toc512118900).

## Пример работы

	МодельЗапроса = Общий.МодельЗапроса();
	//  ЗАПРОС ПАКЕТА. Контрагенты
	МодельЗапроса.ЗапросПакета("Контрагенты")
		.Выбрать()
			.Источник("Справочник._ДемоКонтрагенты")
			.Поле("Ссылка").Поле("ИНН").Поле("КПП")
			.Порядок("Ссылка").Автопорядок();
	//  Обработка результата
	МодельЗапроса.ВыполнитьЗапрос();
	Выборка = МодельЗапроса.ВыбратьРезультат("Контрагенты");

	Пока Выборка.Следующий() Цикл
		Сообщить(СтрШаблон("%1 (%2/%3)", Выборка.Ссылка, Выборка.ИНН, Выборка.КПП));
	КонецЦикла;

В следующем примере демонстрируется возможность изменения существующего запроса.

	ТекстЗапроса = "ВЫБРАТЬ
	|	Контрагенты.Ссылка КАК Ссылка,
	|	Контрагенты.Код КАК Код,
	|	Контрагенты.Наименование КАК Наименование
	|ИЗ
	|	Справочник._ДемоКонтрагенты КАК Контрагенты";

	МодельЗапроса = Общий.МодельЗапроса(ТекстЗапроса)
		.Источник("РегистрСведений.ДополнительныеСведения")
		.ЛевоеСоединение(0, "ДополнительныеСведения").Связь("Ссылка = Объект")
		.Поле("ДополнительныеСведения.*");
На выходе получим:

	ВЫБРАТЬ
		Контрагенты.Ссылка КАК Ссылка,
		Контрагенты.Код КАК Код,
		Контрагенты.Наименование КАК Наименование,
		ДополнительныеСведения.Объект КАК Объект,
		ДополнительныеСведения.Свойство КАК Свойство,
		ДополнительныеСведения.Значение КАК Значение
	ИЗ
		Справочник._ДемоКонтрагенты КАК Контрагенты
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения
			ПО (Контрагенты.Ссылка = ДополнительныеСведения.Объект)

Еще примеры можно посмотреть в статьях:
- ["Модель запроса"](https://infostart.ru/1c/articles/1390402/)
- ["Снежинка для запроса"](https://infostart.ru/1c/articles/1456173/)
- ["Работа со схемой запроса"](https://infostart.ru/1c/articles/811832/)

## Состав

- Конфигурация (этот проект):
  - общие модули
  - модуль библиотеки РаботаСоСхемойЗапроса
  - обработка МодельЗапроса, реализующая объектный интерфейс
- Внешняя обработка "Конструктор модели запроса" (отдельный проект)
- Внешняя обработка "Конструктор схемы запроса" (поставляется как есть)

## Установка

### Обновление через конфигурацию

- Объединить с файлом конфигурации:
  - снять признак объединения с общих свойств
  - установить режим объединения с приоритетом в файле

### Подлючение расширения

- Подключить расширение, снять признак "Безопасный режим"

## Требования

Наличие БСП.
